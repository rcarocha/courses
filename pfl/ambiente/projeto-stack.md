# Gerenciamento de Projetos Haskell com Stack

## Criação do Projeto stack

Um projeto stack é criado com o comando `stack new meuprojeto`, onde `meuprojeto` o nome do seu projeto. O stack criará um diretório `meuprojeto` com a seguinte estrutura de diretórios:


        .
        |-- quicksort
        |   |-- app
        |   |   `-- Main.hs
        |   |-- ChangeLog.md
        |   |-- LICENSE
        |   |-- package.yaml
        |   |-- quicksort.cabal
        |   |-- README.md
        |   |-- Setup.hs
        |   |-- src
        |   |   `-- Lib.hs
        |   |-- stack.yaml
        |   `-- test
        |       `-- Spec.hs
        `-- quicksort.zip


Essencialmente vocês precisarão modificar quatro arquivos:

* `app/Main.hs`: é o seu programa principal, que contém a função `main` e que será a base para o executável criado. 
* `src/Lib.hs`: Diretório onde ficarão as bibliotecas que dão suporte ao seu programa. A idéia é evitar que você coloque todo o código no `Main.hs`, colocando as funções nesse arquivo e importando o módulo no seu `Main.hs`.
* `test/Spec.hs`: contém os testes de unidade do seu código.
* `package.yaml`: contém a configuração do seu projeto. Provavelmente, sua única preocupação nesse arquivo será acrescentar as bibliotecas usadas pelo seu código (indicando o nome delas), que serão baixadas automaticamente ao compilar o seu código.

<img src="images/estrutura-stack.png" />

## Comando stack

* `stack build`: compila o seu código
* `stack run`: executa o seu projeto
* `stack exec meuprojeto-exe`: executa o seu código a partir do executável que, no projeto padrão stack é referenciado pelo nome do projeto seguido de `-exe`. Observe que esse nome aparece no processo de compilação e é definido no arquivo `package.yaml` no bloco de compilação `executables` (trata-se do nome do bloco). No caso do exemplo `quicksort` é `quicksort-exe`.
* `stack test`: executa os testes indicado em `test/Spec.hs`, mostrando resultado no seu terminal.

## Testes de Unidade com Hspec

Um projeto stack utiliza os testes de unidade hspec, e para isso você precisará incluir a biblioteca do Hspec no seu projeto no bloco `dependencies` de `tests`. Veja o exemplo do quicksort.

### Referências úteis

* [HSpec; A importância de testes](http://blog.haskellbr.com/2015/12/10/24-dias-de-hackage-2015-dia-3-hspec-a-importancia-de-testes.html) - em portugues
* <https://hspec.github.io/>
* <https://github.com/hspec/hspec-example>
* <https://hspec.github.io/running-specs.html>


## Exemplo

Segue o exemplo discutido em sala de aula de um falso quicksort. Observem com cuidado os testes.

* Falso [quicksort](code/quicksort.zip)
